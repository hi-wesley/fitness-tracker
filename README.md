# MyHealthnessPal (Prototype)

Unifies sleep, nutrition, activity, and vitals into a single dashboard, with an AI insights layer generated by a backend service.

## Architecture
- Frontend (this repo root): static HTML/CSS/JS deployed on Netlify
- Backend (`backend/`): Node/Express service deployed on Hetzner (OpenAI-powered insights)
- Netlify proxies `/insights` and `/health` to the Hetzner backend via `netlify.toml`

## Deploy
### Netlify (frontend)
- The Netlify config is in `netlify.toml`.
- It builds a minimal `dist/` folder (so only frontend assets are published).
- It proxies `/health` directly to Hetzner, and proxies `/insights` through a Netlify Function so the proxy secret is never exposed client-side.
- Netlify env vars:
  - `MHP_PROXY_SECRET` (must match Hetzner `INSIGHTS_PROXY_SECRET`)
  - `MHP_BACKEND_ORIGIN` (optional; defaults to `http://5.78.180.72:8787`)
- Live URL: `https://my-healthness-pal.netlify.app/`

### Hetzner (backend)
- Run Node 18+ in `backend/`.
- Required env vars: `OPENAI_API_KEY`.
- Recommended (prod) env vars:
  - `NODE_ENV=production`
  - `INSIGHTS_PROXY_SECRET` (required when `NODE_ENV=production`; locks down `/insights`)
- Optional env vars:
  - `OPENAI_MODEL`, `PORT`, `CORS_ORIGIN`
  - Rate limiting: `INSIGHTS_RATE_ANY_PER_MIN`, `INSIGHTS_RATE_POST_PER_MIN`, `INSIGHTS_RATE_GET_PER_MIN`
  - Debug: `INSIGHTS_INCLUDE_RAW=1` (only honored when not in production)
- Live URL: `http://5.78.180.72:8787`

## What’s included
- Dashboard (2×3):
  - Sleep (1/7/30)
  - Exercise (1/7/30)
  - Blood pressure (7/14/30)
  - Physiological stress (1/7/30; previous day)
  - Nutrition (1/7/30)
  - Weight (7/14/30)
- Insights UI scaffold:
  - Overall summary (top, full-width)
  - One insight card per category (layout matches the dashboard)

## Run locally
### Frontend
Use any static server. For example:
- `python3 -m http.server 5173` (or any port)
- `npx serve .` (requires Node + npm; often defaults to port 3000)

Then open the printed URL.

### Backend (AI insights)
- `cd backend`
- Add your OpenAI key to `backend/.env` (`OPENAI_API_KEY=...`)
- If you want to test the auth/proxy flow locally, you can also set `INSIGHTS_PROXY_SECRET=...`
- `npm install`
- `npm run dev`
- Open: `http://localhost:8787` (backend serves the static frontend)
- Verify: `curl http://localhost:8787/health`

## Data format
The app expects a canonical JSON payload with a `records` array (or a raw array of records).
See:
- The schema block in `index.html`
- The built-in sample profiles in the UI
