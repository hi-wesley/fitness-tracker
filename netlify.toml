# Netlify -> Hetzner backend proxy
# Put proxy rules ABOVE any SPA fallback rules.

[build]
  publish = "dist"
  command = "mkdir -p dist && cp index.html app.js styles.css dist/ && mkdir -p dist/modules && cp -R modules/. dist/modules/"

[[redirects]]
  from = "/health"
  to = "http://5.78.180.72:8787/health"
  status = 200
  force = true

[[redirects]]
  from = "/insights"
  to = "/.netlify/functions/insights"
  status = 200
  force = true

# If the frontend ever calls /insights/anything (subpaths), proxy those too:
[[redirects]]
  from = "/insights/*"
  to = "/.netlify/functions/insights"
  status = 200
  force = true

# (Optional) If this is a single-page app and you need SPA fallback:
# Keep this LAST.
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
